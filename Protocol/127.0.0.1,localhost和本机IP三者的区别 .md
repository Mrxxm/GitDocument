## 127.0.0.1,localhost和本机IP三者的区别 

#### 正文

#### OSI七层网络传输模型 环回地址

在说 `127.0.0.1` 之前，我们需要复习两个知识点，七层网络传输模型和环回地址。

#### 七层网络传输模型

网络传输的七层模型从下到上包括：物理层、数据链路层、网络层、传输层、会话层、表示层和应用层。每层有相应的功能和对应的协议。

当我们使用网络传输数据时（例如发送 QQ 消息），发送时从应用层出发，接下来的每一层都对上一层的数据进行一次包装，直到最下面的物理层。然后通过网线或者无线传输给对方。接收是发送的逆过程，每一层通过发送时的包装解析出数据报，然后传给上一层，最终到达应用层。

#### 环回地址

环回地址（LoopBack）是主机用于向自身发送通信的一类特殊地址（也就是一类特殊的目的地址）。

它的特点是同一台主机上的两项服务若使用环回地址而非分配的主机地址通信，就可以绕开 TCP/IP 协议栈的下层。也就是说：不用再通过什么链路层，物理层，以太网传出去了，而是可以直接在自己的网络层，运输层进行处理了。这个特性也被称为**网络层短路**。

当操作系统初始化本机的 TCP/IP 协议栈时，默认设置协议栈本身的 IP 地址为`127.0.0.1`，并注入路由表。当 IP 层接收到目的地址为 `127.0.0.1`（准确的说是：网络号为127的IP）的数据包时，不调用网卡驱动进行二次封装，而是立即转发到本机 IP 层进行处理。因此，通常用 ping `127.0.0.1` 来测试本机 TCP/IP 协议栈是否正常。如果可以 ping 通的话，就说明：本机的网卡和 IP 协议安装都没有问题。（跟当前主机是否联网毫无关系）

#### 127.0.0.1

通过上面的介绍可以知道 `127.0.0.1` 是环回地址中的一个。当我们在浏览器中输入该地址时，它直接通过网络层来寻找目的地址，因为是本机，所以会被本机的 Web 服务器直接监听到，返回指定目录下的文件。

其实，环回地址远不止 `127.0.0.1` 这一个。IPv4 的环回地址为：`127.0.0.0` 到 `127.255.255.255`（有两个特殊的保留），所以你在浏览器中输入这些网络号为 127 的地址都可以显示出 Web 服务器的主页。

#### localhost

localhost 只是一个域名，和 `www.baidu.com` 一样，可以被配置为任何的 IP 地址（修改 hosts 文件）。只不过通常情况下，它都被配置为指向本机地址：

```
IPv4：127.0.0.1        localhost
IPv6：[::1]         localhost
```

上面说过，整个 `127.*` 网段通常被用作环回网络接口的默认地址，按照惯例通常设置为
`127.0.0.1`。

我们用 `locahost` 或者 `127.0.0.1` 作为当前这个主机的地址时，别人不能通过网络访问，即使访问这个地址，也是访问它自己，因为每一台 TCP/IP 协议栈的设备基本上都有 `local/127.0.0.1`。

#### 本机IP

本机 IP，是本机在网络环境中的使用的 IP 地址，指的是“本机物理网卡所绑定的网络协议地址”。通常电脑上都有两个物理网卡，一块是有线网卡（ethernet），一块是无线网卡（wlan），另外还有可能有一个或多个虚拟网卡。

它与上面两种访问方式的区别是：

* 通过本机 IP 来访问自己，需要我们的设备处于联网的状态，受防火墙和网卡限制；
* 可以通过本机和外部访问，也就是在别的设备的浏览器中输入本地 IP，也可以访问 Web 服务器下的文件（如果开放了权限的话）；

#### 总结

1. localhost 就是一个域名，默认指向 `127.0.0.1`（IPV4）和 `::1`（IPV6），相比 `127.0.0.1` 多一个域名解析的过程；
2. `127.0.0.1` 属于回环地址（loopback）中的一个，用于本机各个应用之间的网络交互。传输时不经过数据链路层和物理层；
3. 本机 IP 地址就是联网时使用的网卡分配到的 IP 地址，数据传输时后经过每一层。




